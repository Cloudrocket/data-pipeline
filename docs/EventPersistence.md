# Event persistence: considerations and options

A key architectural decision the team made at the start of the project was how should an event consumer persist the events generated by the event producers. The Event Hub only handles the ingestion and delivery of events, therefore the scenario requires an additional service to handle the persistence. The following sections describe the options the team considered and the reason for the final choice.

## Use Azure Stream Analytics

The Azure Stream Analytics provides a highly available and highly scalable service to enable complex event processing over streaming data. The scenario addressed by the RI does not require the capability to perform complex event processing, but one of the key use cases for Azure Stream Analytics is event archival for future processing. The canonical example described in the Azure Stream Analytics documentation consumes data from the event hub service, performs a stateless transformation on those events, and then archives those events to Blob storage.

For more information about Azure Stream Analytics, see [Introduction to Azure Stream Analytics][azurestreamanalytics].

## Use the Apache Storm service

Apache Storm supports a similar set of use cases to Azure Stream Analytics for processing streams of event data. You can easily deploy an HSInsight Storm cluster in the Azure environment and configure it to act as an event consumer, receiving events from the Event Hub service. In Storm terminology, a *Bolt* is responsible for consuming event streams (for example, from the Event Hub service) or for archiving event data (for example, to Blob storage).

## Implement a custom cold storage event consumer

The third option was to implement a custom cold storage event consumer to receive events from the Event Hub service and persist them to Blob storage. This event consumer would be deployed to Azure as a worker role to enable scaling by running multiple instances.

## Choosing to implement a custom cold storage event consumer

Implementing a custom cold storage event consumer offers increased flexibility and control over how to handle the events at the cost of a greater development effort to build and maintain a custom solution. An additional consideration was that neither Azure Stream Analytics nor HDInsight Storm service were available in Azure at the start of the project to develop the RI. 



[azurestreamanalytics]: http://azure.microsoft.com/en-us/documentation/articles/stream-analytics-introduction/